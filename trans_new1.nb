(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[     67820,       1879]
NotebookOptionsPosition[     63188,       1799]
NotebookOutlinePosition[     63522,       1814]
CellTagsIndexPosition[     63479,       1811]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"c", ">", "0"}], ",", 
     RowBox[{"p", ">", "0"}], ",", 
     RowBox[{"_", "\[Element]", "Reals"}], ",", 
     RowBox[{"p1", ">", "0"}], ",", 
     RowBox[{"\[Theta]1", ">", "0"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.781406650821562*^9, 3.781406658446069*^9}, {
   3.781411640542205*^9, 3.7814116424939623`*^9}, {3.785445783754712*^9, 
   3.785445798483275*^9}, 3.7854524243465433`*^9, {3.791741738065845*^9, 
   3.791741741873291*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"fa31f06f-1395-4700-9c98-b09de72c2660"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"tau", "[", "ii_", "]"}], ":=", 
   RowBox[{
    RowBox[{"-", "I"}], "*", 
    RowBox[{"PauliMatrix", "[", "ii", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.781503138689907*^9, 3.781503138694818*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"a1f611c8-3817-430b-b5b7-b1e751e62667"],

Cell[CellGroupData[{

Cell["Calculation of M", "Subsection",
 CellChangeTimes->{{3.781566287783009*^9, 
  3.781566304553451*^9}},ExpressionUUID->"408318d0-bf28-4d20-a7ed-\
a08506b66a6e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"lambda", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "/", "2"}], 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Tr", "[", 
        RowBox[{
         RowBox[{"MatrixExp", "[", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"c", "[", "a", "]"}], " ", 
             RowBox[{
              RowBox[{"tau", "[", "a", "]"}], "/", "2"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}], ".", 
         RowBox[{"tau", "[", "i", "]"}], ".", 
         RowBox[{"MatrixExp", "[", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"c", "[", "a", "]"}]}], " ", 
             RowBox[{
              RowBox[{"tau", "[", "a", "]"}], "/", "2"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}], ".", 
         RowBox[{"tau", "[", "j", "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], "//", 
    "FullSimplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7814070165723124`*^9, 3.7814070551931467`*^9}, {
  3.7814070914405937`*^9, 3.7814071606205597`*^9}, {3.781407190946323*^9, 
  3.7814071987547827`*^9}, {3.781407296278056*^9, 3.781407297266286*^9}, {
  3.7814301534957304`*^9, 3.781430201112566*^9}, {3.78150314209688*^9, 
  3.781503163808387*^9}, {3.785448159482885*^9, 3.785448160440542*^9}, {
  3.785448237490782*^9, 3.785448259964669*^9}, {3.7854524469814787`*^9, 
  3.785452465253089*^9}, {3.7924389622247353`*^9, 3.792438975447547*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"daffbecf-2cb4-4b7c-a07c-28da81d8e96c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mi1", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"TensorProduct", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"p", "[", "1", "]"}], ",", 
               RowBox[{"p", "[", "2", "]"}], ",", 
               RowBox[{"p", "[", "3", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"p", "[", "1", "]"}], ",", 
               RowBox[{"p", "[", "2", "]"}], ",", 
               RowBox[{"p", "[", "3", "]"}]}], "}"}]}], "]"}], "/", 
           RowBox[{"p", "^", "2"}]}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"TensorContract", "[", 
            RowBox[{
             RowBox[{"TensorProduct", "[", 
              RowBox[{
               RowBox[{"LeviCivitaTensor", "[", "3", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"p", "[", "1", "]"}], ",", 
                 RowBox[{"p", "[", "2", "]"}], ",", 
                 RowBox[{"p", "[", "3", "]"}]}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "4"}], "}"}]}], "]"}]}], "+", 
          RowBox[{"p", " ", 
           RowBox[{
            RowBox[{"Cosh", "[", "p", "]"}], "/", 
            RowBox[{"Sinh", "[", "p", "]"}]}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"DiagonalMatrix", "[", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1", ",", "1"}], "}"}], "]"}], "-", 
             RowBox[{
              RowBox[{"TensorProduct", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"p", "[", "1", "]"}], ",", 
                  RowBox[{"p", "[", "2", "]"}], ",", 
                  RowBox[{"p", "[", "3", "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"p", "[", "1", "]"}], ",", 
                  RowBox[{"p", "[", "2", "]"}], ",", 
                  RowBox[{"p", "[", "3", "]"}]}], "}"}]}], "]"}], "/", 
              RowBox[{"p", "^", "2"}]}]}], ")"}]}]}], "//", "Normal"}], "//", 
        "FullSimplify"}], ")"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p", "[", "a_", "]"}], "\[Rule]", " ", 
        RowBox[{"p0", "[", "a", "]"}]}], "}"}]}], ")"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"p", "\[Rule]", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"p", "[", "1", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"p", "[", "2", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"p", "[", "3", "]"}], "2"]}]]}], ",", 
      RowBox[{"p0", "\[Rule]", " ", "p"}]}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.781407390707925*^9, 3.781407392437392*^9}, {
  3.7814074948850718`*^9, 3.781407524022646*^9}, {3.781407626207361*^9, 
  3.78140776265353*^9}, {3.781407888672195*^9, 3.781407893375723*^9}, {
  3.7854527636746197`*^9, 3.7854527666754427`*^9}, {3.785452837445101*^9, 
  3.785452871620759*^9}, {3.78545291756148*^9, 3.7854530242037783`*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"b16e6039-2594-43d5-ae51-bbefffc220b1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mi2", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"TensorProduct", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"p", "[", "1", "]"}], ",", 
               RowBox[{"p", "[", "2", "]"}], ",", 
               RowBox[{"p", "[", "3", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"p", "[", "1", "]"}], ",", 
               RowBox[{"p", "[", "2", "]"}], ",", 
               RowBox[{"p", "[", "3", "]"}]}], "}"}]}], "]"}], "/", 
           RowBox[{"p", "^", "2"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"TensorContract", "[", 
            RowBox[{
             RowBox[{"TensorProduct", "[", 
              RowBox[{
               RowBox[{"LeviCivitaTensor", "[", "3", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"p", "[", "1", "]"}], ",", 
                 RowBox[{"p", "[", "2", "]"}], ",", 
                 RowBox[{"p", "[", "3", "]"}]}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "4"}], "}"}]}], "]"}]}], "+", 
          RowBox[{"p", " ", 
           RowBox[{
            RowBox[{"Cosh", "[", "p", "]"}], "/", 
            RowBox[{"Sinh", "[", "p", "]"}]}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"DiagonalMatrix", "[", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1", ",", "1"}], "}"}], "]"}], "-", 
             RowBox[{
              RowBox[{"TensorProduct", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"p", "[", "1", "]"}], ",", 
                  RowBox[{"p", "[", "2", "]"}], ",", 
                  RowBox[{"p", "[", "3", "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"p", "[", "1", "]"}], ",", 
                  RowBox[{"p", "[", "2", "]"}], ",", 
                  RowBox[{"p", "[", "3", "]"}]}], "}"}]}], "]"}], "/", 
              RowBox[{"p", "^", "2"}]}]}], ")"}]}]}], "//", "Normal"}], "//", 
        "FullSimplify"}], ")"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p", "[", "a_", "]"}], "\[Rule]", " ", 
        RowBox[{"p0", "[", "a", "]"}]}], "}"}]}], ")"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"p", "\[Rule]", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"p", "[", "1", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"p", "[", "2", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"p", "[", "3", "]"}], "2"]}]]}], ",", 
      RowBox[{"p0", "\[Rule]", " ", "p"}]}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.781407921230165*^9, 3.781407929525609*^9}, {
  3.785453040236765*^9, 3.785453059053081*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"2e03c341-f0d7-43f2-b75a-7b4918f71a28"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"M1", "=", 
   RowBox[{"2", 
    RowBox[{"TensorContract", "[", 
     RowBox[{
      RowBox[{"TensorProduct", "[", 
       RowBox[{"lambda", ",", "lambda", ",", "mi1"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"2", ",", "5"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4", ",", "6"}], "}"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M2", "=", 
   RowBox[{"2", 
    RowBox[{"TensorContract", "[", 
     RowBox[{
      RowBox[{"TensorProduct", "[", 
       RowBox[{"lambda", ",", "lambda", ",", "mi2"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"2", ",", "5"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4", ",", "6"}], "}"}]}], "}"}]}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7814077826439333`*^9, 3.7814078488435297`*^9}, {
  3.781407900476398*^9, 3.781407931922838*^9}, {3.7854530790071917`*^9, 
  3.785453079429618*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"d6042bc0-baa2-473d-9ccd-def4697f56d5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"M1C", " ", "=", " ", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"f", "=", "1"}], "3"], 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"d", "=", "1"}], "3"], 
         RowBox[{
          RowBox[{"lambda", "[", 
           RowBox[{"[", 
            RowBox[{"a", ",", "f"}], "]"}], "]"}], 
          RowBox[{"lambda", "[", 
           RowBox[{"[", 
            RowBox[{"b", ",", "d"}], "]"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{"p", "[", "f", "]"}], "p1"], 
             FractionBox[
              RowBox[{"p", "[", "d", "]"}], "p1"]}], "-", 
            RowBox[{"I", " ", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"e", "=", "1"}], "3"], 
              RowBox[{
               RowBox[{
                RowBox[{"LeviCivitaTensor", "[", "3", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"f", ",", "d", ",", "e"}], "]"}], "]"}], 
               RowBox[{"p", "[", "e", "]"}]}]}]}], "+", 
            RowBox[{
             FractionBox[
              RowBox[{"p1", " ", 
               RowBox[{"Cosh", "[", "p1", "]"}]}], 
              RowBox[{"Sinh", "[", "p1", "]"}]], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"KroneckerDelta", "[", 
                RowBox[{"f", ",", "d"}], "]"}], "-", 
               RowBox[{
                FractionBox[
                 RowBox[{"p", "[", "f", "]"}], "p1"], 
                FractionBox[
                 RowBox[{"p", "[", "d", "]"}], "p1"]}]}], ")"}]}]}], 
           ")"}]}]}]}]}], " ", "/.", " ", "\n", "    ", 
      RowBox[{"p1", " ", "\[Rule]", "  ", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], "^", "2"}], " ", "+", " ", 
         RowBox[{
          RowBox[{"p", "[", "2", "]"}], "^", "2"}], " ", "+", " ", 
         RowBox[{
          RowBox[{"p", "[", "3", "]"}], "^", "2"}]}], "]"}]}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"a", ",", " ", "1", ",", " ", "3"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"b", ",", " ", "1", ",", " ", "3"}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"M2C", " ", "=", " ", 
    RowBox[{"ParallelTable", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"f", "=", "1"}], "3"], 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"d", "=", "1"}], "3"], 
          RowBox[{
           RowBox[{"lambda", "[", 
            RowBox[{"[", 
             RowBox[{"a", ",", "f"}], "]"}], "]"}], 
           RowBox[{"lambda", "[", 
            RowBox[{"[", 
             RowBox[{"b", ",", "d"}], "]"}], "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"p", "[", "f", "]"}], "p1"], 
              FractionBox[
               RowBox[{"p", "[", "d", "]"}], "p1"]}], "+", 
             RowBox[{"I", " ", 
              RowBox[{
               UnderoverscriptBox["\[Sum]", 
                RowBox[{"e", "=", "1"}], "3"], 
               RowBox[{
                RowBox[{
                 RowBox[{"LeviCivitaTensor", "[", "3", "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"f", ",", "d", ",", "e"}], "]"}], "]"}], 
                RowBox[{"p", "[", "e", "]"}]}]}]}], "+", 
             RowBox[{
              FractionBox[
               RowBox[{"p1", " ", 
                RowBox[{"Cosh", "[", "p1", "]"}]}], 
               RowBox[{"Sinh", "[", "p1", "]"}]], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"KroneckerDelta", "[", 
                 RowBox[{"f", ",", "d"}], "]"}], "-", 
                RowBox[{
                 FractionBox[
                  RowBox[{"p", "[", "f", "]"}], "p1"], 
                 FractionBox[
                  RowBox[{"p", "[", "d", "]"}], "p1"]}]}], ")"}]}]}], 
            ")"}]}]}]}]}], " ", "/.", " ", "\n", "    ", 
       RowBox[{"p1", " ", "\[Rule]", "  ", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"p", "[", "1", "]"}], "^", "2"}], " ", "+", " ", 
          RowBox[{
           RowBox[{"p", "[", "2", "]"}], "^", "2"}], " ", "+", " ", 
          RowBox[{
           RowBox[{"p", "[", "3", "]"}], "^", "2"}]}], "]"}]}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"a", ",", " ", "1", ",", " ", "3"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"b", ",", " ", "1", ",", " ", "3"}], "}"}]}], "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{"M1C", " ", "-", " ", "M1"}], " ", "//", " ", "Expand"}], "\n", 
 RowBox[{
  RowBox[{"M2C", " ", "-", " ", "M2"}], " ", "//", " ", "Expand"}]}], "Input",\

 CellChangeTimes->{{3.79245331648374*^9, 3.792453358161162*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"b9ff97bf-be77-4fa2-a543-7fdcf45b2725"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.792478641904849*^9},
 CellLabel->"Out[28]=",ExpressionUUID->"428e4306-195b-494e-9f9a-1dda096b8901"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.792478642092943*^9},
 CellLabel->"Out[29]=",ExpressionUUID->"b333bc72-4366-4057-a99b-3b1e3b627a89"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"muscale", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]", "[", "a_", "]"}], "\[Rule]", " ", 
      RowBox[{"\[Mu]", " ", 
       RowBox[{"\[Theta]", "[", "a", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"p", "[", "a_", "]"}], "\[Rule]", " ", 
      RowBox[{
       FractionBox[
        SuperscriptBox["\[Mu]", "2"], 
        RowBox[{"\[Beta]", " ", 
         SuperscriptBox["aa", "2"]}]], 
       RowBox[{"p", "[", "a", "]"}]}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7924971490005283`*^9, 3.792497233918296*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"5711d008-b564-4263-b8ee-fa66d156fe38"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"M1exp", "=", 
  RowBox[{"ParallelTable", "[", 
   RowBox[{
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"M1", "[", 
          RowBox[{"[", 
           RowBox[{"a", ",", "b"}], "]"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{"c", "\[Rule]", "\[Theta]"}], "}"}]}], ")"}], "/.", 
       "muscale"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Mu]", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "1", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"b", ",", "1", ",", "3"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7924971134968557`*^9, 3.792497142106999*^9}, {
  3.79249728296957*^9, 3.79249737354736*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"aa2291c4-17b6-4159-abf0-fc6029b453c2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      RowBox[{"2", "+", 
       InterpretationBox[
        SuperscriptBox[
         RowBox[{"O", "[", "\[Mu]", "]"}], "2"],
        SeriesData[$CellContext`\[Mu], 0, {}, 0, 2, 1],
        Editable->False]}],
      SeriesData[$CellContext`\[Mu], 0, {2}, 0, 2, 1],
      Editable->False], ",", 
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Mu]", "]"}], "2"],
      SeriesData[$CellContext`\[Mu], 0, {}, 2, 2, 1],
      Editable->False], ",", 
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Mu]", "]"}], "2"],
      SeriesData[$CellContext`\[Mu], 0, {}, 2, 2, 1],
      Editable->False]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Mu]", "]"}], "2"],
      SeriesData[$CellContext`\[Mu], 0, {}, 2, 2, 1],
      Editable->False], ",", 
     InterpretationBox[
      RowBox[{"2", "+", 
       InterpretationBox[
        SuperscriptBox[
         RowBox[{"O", "[", "\[Mu]", "]"}], "2"],
        SeriesData[$CellContext`\[Mu], 0, {}, 0, 2, 1],
        Editable->False]}],
      SeriesData[$CellContext`\[Mu], 0, {2}, 0, 2, 1],
      Editable->False], ",", 
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Mu]", "]"}], "2"],
      SeriesData[$CellContext`\[Mu], 0, {}, 2, 2, 1],
      Editable->False]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Mu]", "]"}], "2"],
      SeriesData[$CellContext`\[Mu], 0, {}, 2, 2, 1],
      Editable->False], ",", 
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Mu]", "]"}], "2"],
      SeriesData[$CellContext`\[Mu], 0, {}, 2, 2, 1],
      Editable->False], ",", 
     InterpretationBox[
      RowBox[{"2", "+", 
       InterpretationBox[
        SuperscriptBox[
         RowBox[{"O", "[", "\[Mu]", "]"}], "2"],
        SeriesData[$CellContext`\[Mu], 0, {}, 0, 2, 1],
        Editable->False]}],
      SeriesData[$CellContext`\[Mu], 0, {2}, 0, 2, 1],
      Editable->False]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7924973568057833`*^9, 3.792497374820035*^9}},
 CellLabel->"Out[33]=",ExpressionUUID->"55ac17c6-cc4f-4a2e-8d69-02ebe4131ce6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"M2exp", "=", 
  RowBox[{"ParallelTable", "[", 
   RowBox[{
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"M2", "[", 
          RowBox[{"[", 
           RowBox[{"a", ",", "b"}], "]"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{"c", "\[Rule]", "\[Theta]"}], "}"}]}], ")"}], "/.", 
       "muscale"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Mu]", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "1", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"b", ",", "1", ",", "3"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.792497395193755*^9, 3.792497397562839*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"687f7d54-08a5-4959-a0c0-81fd2a43efb1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      RowBox[{"2", "+", 
       InterpretationBox[
        SuperscriptBox[
         RowBox[{"O", "[", "\[Mu]", "]"}], "2"],
        SeriesData[$CellContext`\[Mu], 0, {}, 0, 2, 1],
        Editable->False]}],
      SeriesData[$CellContext`\[Mu], 0, {2}, 0, 2, 1],
      Editable->False], ",", 
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Mu]", "]"}], "2"],
      SeriesData[$CellContext`\[Mu], 0, {}, 2, 2, 1],
      Editable->False], ",", 
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Mu]", "]"}], "2"],
      SeriesData[$CellContext`\[Mu], 0, {}, 2, 2, 1],
      Editable->False]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Mu]", "]"}], "2"],
      SeriesData[$CellContext`\[Mu], 0, {}, 2, 2, 1],
      Editable->False], ",", 
     InterpretationBox[
      RowBox[{"2", "+", 
       InterpretationBox[
        SuperscriptBox[
         RowBox[{"O", "[", "\[Mu]", "]"}], "2"],
        SeriesData[$CellContext`\[Mu], 0, {}, 0, 2, 1],
        Editable->False]}],
      SeriesData[$CellContext`\[Mu], 0, {2}, 0, 2, 1],
      Editable->False], ",", 
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Mu]", "]"}], "2"],
      SeriesData[$CellContext`\[Mu], 0, {}, 2, 2, 1],
      Editable->False]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Mu]", "]"}], "2"],
      SeriesData[$CellContext`\[Mu], 0, {}, 2, 2, 1],
      Editable->False], ",", 
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Mu]", "]"}], "2"],
      SeriesData[$CellContext`\[Mu], 0, {}, 2, 2, 1],
      Editable->False], ",", 
     InterpretationBox[
      RowBox[{"2", "+", 
       InterpretationBox[
        SuperscriptBox[
         RowBox[{"O", "[", "\[Mu]", "]"}], "2"],
        SeriesData[$CellContext`\[Mu], 0, {}, 0, 2, 1],
        Editable->False]}],
      SeriesData[$CellContext`\[Mu], 0, {2}, 0, 2, 1],
      Editable->False]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.792497399976721*^9},
 CellLabel->"Out[34]=",ExpressionUUID->"a96f2672-5d7a-420f-ac44-78f104245485"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Compute Tras1new in EOMs    (- ",
 Cell[BoxData[
  FormBox[
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     SuperscriptBox["a", "2"]}], "\[Kappa]"], TraditionalForm]],
  ExpressionUUID->"06721e0a-6d19-4fbc-aed5-b25b3375dff2"],
 ") ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    SuperscriptBox[
     RowBox[{"(", "Trans1new", ")"}], "b"], "a"], TraditionalForm]],
  ExpressionUUID->"87efdba7-a66b-4ac9-a07d-906b463084fd"],
 "  ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {
       FractionBox[
        RowBox[{"d", " ", 
         RowBox[{
          SuperscriptBox["p", "a"], "(", "e", ")"}]}], 
        RowBox[{"d", " ", "\[Tau]"}]]},
      {
       FractionBox[
        RowBox[{"d", " ", 
         RowBox[{
          SuperscriptBox["\[Theta]", "a"], "(", "e", ")"}]}], 
        RowBox[{"d", " ", "\[Tau]"}]]}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "a5ef339c-8371-4d05-ac63-6f8b0810f9ad"],
 "  =  ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {
       FractionBox[
        RowBox[{"\[PartialD]", "H"}], 
        RowBox[{"\[PartialD]", 
         RowBox[{
          SuperscriptBox["p", "a"], "(", "e", ")"}]}]]},
      {
       FractionBox[
        RowBox[{"\[PartialD]", "H"}], 
        RowBox[{"\[PartialD]", 
         RowBox[{
          SuperscriptBox["\[Theta]", "a"], "(", "e", ")"}]}]]}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "512fa20b-4bd5-424e-86aa-8334753f3412"]
}], "Subsection",
 CellChangeTimes->{{3.781566330375702*^9, 3.78156633269597*^9}, 
   3.7815909310176773`*^9, {3.792275878816317*^9, 
   3.79227591682029*^9}},ExpressionUUID->"8e523cf8-be33-462f-9362-\
5cc03d18a502"],

Cell["Load saved J data", "Text",
 CellChangeTimes->{{3.781590826345133*^9, 3.7815908318785563`*^9}, {
  3.781590919465632*^9, 
  3.78159092015609*^9}},ExpressionUUID->"852bb0fc-dec5-490c-b850-\
eba0f7b3a3a5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Get", "[", 
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<JJPhi_han.wl\>\""}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Get", "[", 
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<JJ_han.wl\>\""}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7815906235548153`*^9, 3.781590630771751*^9}, {
  3.781590668117097*^9, 3.781590678321619*^9}, {3.781590781178825*^9, 
  3.7815907819416227`*^9}, {3.785445973322598*^9, 3.785446010597522*^9}, {
  3.785453170635063*^9, 3.785453184453785*^9}, {3.785453270218501*^9, 
  3.785453300391069*^9}, {3.791737598439953*^9, 3.791737618480242*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"f88e32ab-bc65-4ab7-90d1-2a6b60987a33"],

Cell[BoxData[
 RowBox[{
  RowBox[{"JJ1", "=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Refine", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Refine", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"JJ", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "//", "FunctionExpand"}],
            ",", 
           RowBox[{"Assumptions", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"p", "[", "1", "]"}], "\[Element]", " ", "Reals"}], 
              ",", 
              RowBox[{
               RowBox[{"p", "[", "2", "]"}], "\[Element]", " ", "Reals"}], 
              ",", 
              RowBox[{
               RowBox[{"p", "[", "3", "]"}], "\[Element]", " ", "Reals"}], 
              ",", 
              RowBox[{
               RowBox[{"c", "[", "1", "]"}], "\[Element]", " ", "Reals"}], 
              ",", 
              RowBox[{
               RowBox[{"c", "[", "2", "]"}], "\[Element]", " ", "Reals"}], 
              ",", 
              RowBox[{
               RowBox[{"c", "[", "3", "]"}], "\[Element]", " ", "Reals"}]}], 
             "}"}]}]}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"p", "[", "1", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"p", "[", "2", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"p", "[", "3", "]"}], "2"]}], "\[Rule]", " ", 
            SuperscriptBox["p1", "2"]}], ",", 
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"c", "[", "1", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"c", "[", "2", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"c", "[", "3", "]"}], "2"]}], "\[Rule]", 
            SuperscriptBox["\[Theta]1", "2"]}]}], "}"}]}], ",", 
        RowBox[{"Assumptions", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"p1", ">", "0"}], ",", 
           RowBox[{"\[Theta]1", ">", "0"}]}], "}"}]}]}], "]"}], "//", 
      "Simplify"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7917376267538023`*^9, 3.7917376582868843`*^9}, {
   3.791737723446789*^9, 3.791737772564975*^9}, {3.7917379109958763`*^9, 
   3.791737914330761*^9}, {3.79173802828907*^9, 3.7917380469222927`*^9}, {
   3.7917414496439*^9, 3.791741473104925*^9}, {3.791742354346703*^9, 
   3.7917423606402884`*^9}, 3.791743545208805*^9},
 CellLabel->"In[10]:=",ExpressionUUID->"63bbeef8-5234-4a8d-919e-d6345ca61474"],

Cell[BoxData[
 RowBox[{
  RowBox[{"JJ1exp", "=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"Series", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"JJ1", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"c", "\[Rule]", "\[Theta]"}], ",", 
            RowBox[{"\[Theta]1", "\[Rule]", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"\[Theta]", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"\[Theta]", "[", "2", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"\[Theta]", "[", "3", "]"}], "2"]}]]}], ",", 
            RowBox[{"p1", "\[Rule]", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"p", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"p", "[", "2", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"p", "[", "3", "]"}], "2"]}]]}]}], "}"}]}], ")"}], "/.",
         "muscale"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Mu]", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7924974291074133`*^9, 3.792497587456881*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"17d12ff0-3b92-4176-9cf4-140e60fcb381"],

Cell[BoxData[
 RowBox[{
  RowBox[{"JJPhi1", "=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Refine", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Refine", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"JJPhi", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "//", "FunctionExpand"}],
            ",", 
           RowBox[{"Assumptions", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"p", "[", "1", "]"}], "\[Element]", " ", "Reals"}], 
              ",", 
              RowBox[{
               RowBox[{"p", "[", "2", "]"}], "\[Element]", " ", "Reals"}], 
              ",", 
              RowBox[{
               RowBox[{"p", "[", "3", "]"}], "\[Element]", " ", "Reals"}], 
              ",", 
              RowBox[{
               RowBox[{"c", "[", "1", "]"}], "\[Element]", " ", "Reals"}], 
              ",", 
              RowBox[{
               RowBox[{"c", "[", "2", "]"}], "\[Element]", " ", "Reals"}], 
              ",", 
              RowBox[{
               RowBox[{"c", "[", "3", "]"}], "\[Element]", " ", "Reals"}]}], 
             "}"}]}]}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"p", "[", "1", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"p", "[", "2", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"p", "[", "3", "]"}], "2"]}], "\[Rule]", " ", 
            SuperscriptBox["p1", "2"]}], ",", 
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"c", "[", "1", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"c", "[", "2", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"c", "[", "3", "]"}], "2"]}], "\[Rule]", 
            SuperscriptBox["\[Theta]1", "2"]}]}], "}"}]}], ",", 
        RowBox[{"Assumptions", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"p1", ">", "0"}], ",", 
           RowBox[{"\[Theta]1", ">", "0"}]}], "}"}]}]}], "]"}], "//", 
      "Simplify"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.791738050556971*^9, 3.79173806250283*^9}, {
   3.791741590469432*^9, 3.791741604289749*^9}, 3.791742369015592*^9, 
   3.791743552487109*^9},
 CellLabel->"In[11]:=",ExpressionUUID->"a27e614b-857b-4df1-9d44-1ba347e1f0f0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"JJPhi1exp", "=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"Series", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"JJPhi1", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"c", "\[Rule]", "\[Theta]"}], ",", 
            RowBox[{"\[Theta]1", "\[Rule]", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"\[Theta]", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"\[Theta]", "[", "2", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"\[Theta]", "[", "3", "]"}], "2"]}]]}], ",", 
            RowBox[{"p1", "\[Rule]", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"p", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"p", "[", "2", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"p", "[", "3", "]"}], "2"]}]]}]}], "}"}]}], ")"}], "/.",
         "muscale"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Mu]", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7924976010942287`*^9, 3.792497623613558*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"89a6c905-4a8c-4d56-bd27-652a965a021d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"M1S", "=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Refine", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"M1", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"p", "[", "1", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"p", "[", "2", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"p", "[", "3", "]"}], "2"]}], "\[Rule]", " ", 
            SuperscriptBox["p1", "2"]}], ",", 
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"c", "[", "1", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"c", "[", "2", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"c", "[", "3", "]"}], "2"]}], "\[Rule]", 
            SuperscriptBox["\[Theta]1", "2"]}]}], "}"}]}], ",", 
        RowBox[{"Assumptions", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"p1", ">", "0"}], ",", 
           RowBox[{"\[Theta]1", ">", "0"}]}], "}"}]}]}], "]"}], "//", 
      "Simplify"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7917416217438593`*^9, 3.791741708581481*^9}, 
   3.791742373700626*^9, 3.7917435580708323`*^9},
 CellLabel->"In[12]:=",ExpressionUUID->"adbfe21b-60ad-4b8a-863d-d573e35eeea9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"M2S", "=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Refine", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"M2", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"p", "[", "1", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"p", "[", "2", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"p", "[", "3", "]"}], "2"]}], "\[Rule]", " ", 
            SuperscriptBox["p1", "2"]}], ",", 
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"c", "[", "1", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"c", "[", "2", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"c", "[", "3", "]"}], "2"]}], "\[Rule]", 
            SuperscriptBox["\[Theta]1", "2"]}]}], "}"}]}], ",", 
        RowBox[{"Assumptions", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"p1", ">", "0"}], ",", 
           RowBox[{"\[Theta]1", ">", "0"}]}], "}"}]}]}], "]"}], "//", 
      "Simplify"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.791741963920209*^9, 3.791741968867896*^9}, 
   3.791742382087932*^9, 3.791743562914977*^9},
 CellLabel->"In[13]:=",ExpressionUUID->"00aeaebb-176a-4259-b88c-04c81232f2ff"],

Cell[TextData[{
 "(- ",
 Cell[BoxData[
  FormBox[
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     SuperscriptBox["a", "2"]}], "\[Kappa]"], TraditionalForm]],
  ExpressionUUID->"54bdf28b-4daa-403e-b723-9082ab20028c"],
 ") ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    SuperscriptBox[
     RowBox[{"(", "Trans1new", ")"}], "b"], "a"], TraditionalForm]],
  ExpressionUUID->"8b468d3d-ab05-4de8-b79f-ee9d6f2450db"],
 "  ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {
       FractionBox[
        RowBox[{"d", " ", 
         RowBox[{
          SuperscriptBox["p", "a"], "(", "e", ")"}]}], 
        RowBox[{"d", " ", "\[Tau]"}]]},
      {
       FractionBox[
        RowBox[{"d", " ", 
         RowBox[{
          SuperscriptBox["\[Theta]", "a"], "(", "e", ")"}]}], 
        RowBox[{"d", " ", "\[Tau]"}]]}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "37fec28a-c2f0-4c63-91ab-fe33a6abeef7"],
 "  =  ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {
       FractionBox[
        RowBox[{"\[PartialD]", "H"}], 
        RowBox[{"\[PartialD]", 
         RowBox[{
          SuperscriptBox["p", "a"], "(", "e", ")"}]}]]},
      {
       FractionBox[
        RowBox[{"\[PartialD]", "H"}], 
        RowBox[{"\[PartialD]", 
         RowBox[{
          SuperscriptBox["\[Theta]", "a"], "(", "e", ")"}]}]]}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "5cac986e-67e2-4bde-9826-5d48f4519206"]
}], "Text",
 CellChangeTimes->{{3.7854472105049067`*^9, 3.785447385830285*^9}, {
  3.7854539070694447`*^9, 3.785453907503364*^9}, {3.785454009752358*^9, 
  3.785454061951496*^9}, {3.785679577097046*^9, 
  3.7856796030634203`*^9}},ExpressionUUID->"df5405de-0929-479f-9fc6-\
c31e9fe6f54b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Trans1new", " ", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Transpose", "[", "JJ1", "]"}], ".", 
      RowBox[{"ArrayFlatten", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"M1S", ",", 
           RowBox[{"DiagonalMatrix", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"DiagonalMatrix", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}], "]"}], ",", 
           RowBox[{"-", "M2S"}]}], "}"}]}], "}"}], "]"}], ".", "JJPhi1"}], 
     ")"}], "/.", 
    RowBox[{"c", "\[Rule]", " ", "\[Theta]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7814080560216827`*^9, 3.781408073827178*^9}, {
   3.781408156378763*^9, 3.781408303291881*^9}, {3.7814083537716837`*^9, 
   3.781408354060546*^9}, {3.781408386210359*^9, 3.7814083909881372`*^9}, {
   3.781432451776873*^9, 3.7814324706440105`*^9}, {3.781503191538436*^9, 
   3.7815031922752943`*^9}, {3.78159038479578*^9, 3.781590391657867*^9}, 
   3.7815908481206903`*^9, {3.781590938585556*^9, 3.781590939450666*^9}, {
   3.781599655520403*^9, 3.781599658415564*^9}, {3.785446306225095*^9, 
   3.785446328387342*^9}, 3.7854467566220837`*^9, {3.785446824449553*^9, 
   3.785446828080949*^9}, {3.785448311847436*^9, 3.785448371593677*^9}, {
   3.785448973573131*^9, 3.785448988654982*^9}, {3.785453317553742*^9, 
   3.7854533639811687`*^9}, {3.785453521064116*^9, 3.7854535406690273`*^9}, {
   3.785454378374709*^9, 3.7854544045307283`*^9}, {3.791738218331148*^9, 
   3.79173825086052*^9}, {3.791741976387175*^9, 3.791741978614317*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"67d1f21e-a708-42cf-b7f6-f9bc700f218e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Trans1newexp", "=", 
  RowBox[{"Series", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Transpose", "[", "JJ1exp", "]"}], ".", 
      RowBox[{"ArrayFlatten", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"M1exp", ",", 
           RowBox[{"DiagonalMatrix", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"DiagonalMatrix", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}], "]"}], ",", 
           RowBox[{"-", "M2exp"}]}], "}"}]}], "}"}], "]"}], ".", 
      "JJPhi1exp"}], ")"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Mu]", ",", "0", ",", "0"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7924976317436447`*^9, 3.792497732612946*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"b794552f-b7ce-4220-9baf-3d81826b89f2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Mu]", "]"}], "2"],
      SeriesData[$CellContext`\[Mu], 0, {}, 2, 2, 1],
      Editable->False], ",", 
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Mu]", "]"}], "2"],
      SeriesData[$CellContext`\[Mu], 0, {}, 2, 2, 1],
      Editable->False], ",", 
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Mu]", "]"}], "2"],
      SeriesData[$CellContext`\[Mu], 0, {}, 2, 2, 1],
      Editable->False], ",", 
     InterpretationBox[
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], "+", 
       InterpretationBox[
        SuperscriptBox[
         RowBox[{"O", "[", "\[Mu]", "]"}], "1"],
        SeriesData[$CellContext`\[Mu], 0, {}, 0, 1, 1],
        Editable->False]}],
      SeriesData[$CellContext`\[Mu], 0, {
        Complex[0, -1]}, 0, 1, 1],
      Editable->False], ",", 
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Mu]", "]"}], "1"],
      SeriesData[$CellContext`\[Mu], 0, {}, 1, 1, 1],
      Editable->False], ",", 
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Mu]", "]"}], "1"],
      SeriesData[$CellContext`\[Mu], 0, {}, 1, 1, 1],
      Editable->False]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Mu]", "]"}], "2"],
      SeriesData[$CellContext`\[Mu], 0, {}, 2, 2, 1],
      Editable->False], ",", 
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Mu]", "]"}], "2"],
      SeriesData[$CellContext`\[Mu], 0, {}, 2, 2, 1],
      Editable->False], ",", 
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Mu]", "]"}], "2"],
      SeriesData[$CellContext`\[Mu], 0, {}, 2, 2, 1],
      Editable->False], ",", 
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Mu]", "]"}], "1"],
      SeriesData[$CellContext`\[Mu], 0, {}, 1, 1, 1],
      Editable->False], ",", 
     InterpretationBox[
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], "+", 
       InterpretationBox[
        SuperscriptBox[
         RowBox[{"O", "[", "\[Mu]", "]"}], "1"],
        SeriesData[$CellContext`\[Mu], 0, {}, 0, 1, 1],
        Editable->False]}],
      SeriesData[$CellContext`\[Mu], 0, {
        Complex[0, -1]}, 0, 1, 1],
      Editable->False], ",", 
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Mu]", "]"}], "1"],
      SeriesData[$CellContext`\[Mu], 0, {}, 1, 1, 1],
      Editable->False]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Mu]", "]"}], "2"],
      SeriesData[$CellContext`\[Mu], 0, {}, 2, 2, 1],
      Editable->False], ",", 
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Mu]", "]"}], "2"],
      SeriesData[$CellContext`\[Mu], 0, {}, 2, 2, 1],
      Editable->False], ",", 
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Mu]", "]"}], "2"],
      SeriesData[$CellContext`\[Mu], 0, {}, 2, 2, 1],
      Editable->False], ",", 
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Mu]", "]"}], "1"],
      SeriesData[$CellContext`\[Mu], 0, {}, 1, 1, 1],
      Editable->False], ",", 
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Mu]", "]"}], "1"],
      SeriesData[$CellContext`\[Mu], 0, {}, 1, 1, 1],
      Editable->False], ",", 
     InterpretationBox[
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], "+", 
       InterpretationBox[
        SuperscriptBox[
         RowBox[{"O", "[", "\[Mu]", "]"}], "1"],
        SeriesData[$CellContext`\[Mu], 0, {}, 0, 1, 1],
        Editable->False]}],
      SeriesData[$CellContext`\[Mu], 0, {
        Complex[0, -1]}, 0, 1, 1],
      Editable->False]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      RowBox[{"\[ImaginaryI]", "+", 
       InterpretationBox[
        SuperscriptBox[
         RowBox[{"O", "[", "\[Mu]", "]"}], "1"],
        SeriesData[$CellContext`\[Mu], 0, {}, 0, 1, 1],
        Editable->False]}],
      SeriesData[$CellContext`\[Mu], 0, {
        Complex[0, 1]}, 0, 1, 1],
      Editable->False], ",", 
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Mu]", "]"}], "1"],
      SeriesData[$CellContext`\[Mu], 0, {}, 1, 1, 1],
      Editable->False], ",", 
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Mu]", "]"}], "1"],
      SeriesData[$CellContext`\[Mu], 0, {}, 1, 1, 1],
      Editable->False], ",", 
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Mu]", "]"}], "2"],
      SeriesData[$CellContext`\[Mu], 0, {}, 2, 2, 1],
      Editable->False], ",", 
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Mu]", "]"}], "2"],
      SeriesData[$CellContext`\[Mu], 0, {}, 2, 2, 1],
      Editable->False], ",", 
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Mu]", "]"}], "2"],
      SeriesData[$CellContext`\[Mu], 0, {}, 2, 2, 1],
      Editable->False]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Mu]", "]"}], "1"],
      SeriesData[$CellContext`\[Mu], 0, {}, 1, 1, 1],
      Editable->False], ",", 
     InterpretationBox[
      RowBox[{"\[ImaginaryI]", "+", 
       InterpretationBox[
        SuperscriptBox[
         RowBox[{"O", "[", "\[Mu]", "]"}], "1"],
        SeriesData[$CellContext`\[Mu], 0, {}, 0, 1, 1],
        Editable->False]}],
      SeriesData[$CellContext`\[Mu], 0, {
        Complex[0, 1]}, 0, 1, 1],
      Editable->False], ",", 
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Mu]", "]"}], "1"],
      SeriesData[$CellContext`\[Mu], 0, {}, 1, 1, 1],
      Editable->False], ",", 
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Mu]", "]"}], "2"],
      SeriesData[$CellContext`\[Mu], 0, {}, 2, 2, 1],
      Editable->False], ",", 
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Mu]", "]"}], "2"],
      SeriesData[$CellContext`\[Mu], 0, {}, 2, 2, 1],
      Editable->False], ",", 
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Mu]", "]"}], "2"],
      SeriesData[$CellContext`\[Mu], 0, {}, 2, 2, 1],
      Editable->False]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Mu]", "]"}], "1"],
      SeriesData[$CellContext`\[Mu], 0, {}, 1, 1, 1],
      Editable->False], ",", 
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Mu]", "]"}], "1"],
      SeriesData[$CellContext`\[Mu], 0, {}, 1, 1, 1],
      Editable->False], ",", 
     InterpretationBox[
      RowBox[{"\[ImaginaryI]", "+", 
       InterpretationBox[
        SuperscriptBox[
         RowBox[{"O", "[", "\[Mu]", "]"}], "1"],
        SeriesData[$CellContext`\[Mu], 0, {}, 0, 1, 1],
        Editable->False]}],
      SeriesData[$CellContext`\[Mu], 0, {
        Complex[0, 1]}, 0, 1, 1],
      Editable->False], ",", 
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Mu]", "]"}], "2"],
      SeriesData[$CellContext`\[Mu], 0, {}, 2, 2, 1],
      Editable->False], ",", 
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Mu]", "]"}], "2"],
      SeriesData[$CellContext`\[Mu], 0, {}, 2, 2, 1],
      Editable->False], ",", 
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "\[Mu]", "]"}], "2"],
      SeriesData[$CellContext`\[Mu], 0, {}, 2, 2, 1],
      Editable->False]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.792497670995908*^9, 3.792497733918084*^9}},
 CellLabel->"Out[45]=",ExpressionUUID->"3fe2d486-b752-4753-89e2-07f507af6ca3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Trans1newexp", "//", "Normal"}], "//", "TeXForm"}]], "Input",
 CellChangeTimes->{{3.792497739467162*^9, 3.79249774790374*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"09a09480-7e62-4040-b5cc-5ce0118c8c15"],

Cell["\<\
\\left(
\\begin{array}{cccccc}
 0 & 0 & 0 & -i & 0 & 0 \\\\
 0 & 0 & 0 & 0 & -i & 0 \\\\
 0 & 0 & 0 & 0 & 0 & -i \\\\
 i & 0 & 0 & 0 & 0 & 0 \\\\
 0 & i & 0 & 0 & 0 & 0 \\\\
 0 & 0 & i & 0 & 0 & 0 \\\\
\\end{array}
\\right)\
\>", "Output",
 CellChangeTimes->{3.79249776392559*^9},
 CellLabel->
  "Out[47]//TeXForm=",ExpressionUUID->"550fe9dd-c2b0-4fb7-9799-c8ecd4e64765"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Save", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<Trans1new.wl\>\""}], 
   ",", "Trans1new"}], "]"}]], "Input",
 CellChangeTimes->{{3.7917563165092077`*^9, 3.791756345945853*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"61b38d8f-6c4b-440f-8adc-c4b1d9d3de03"]
}, Open  ]],

Cell[CellGroupData[{

Cell["EOMs as Hamiltonian equations", "Section",
 CellChangeTimes->{{3.792275950040134*^9, 3.792275971434823*^9}, {
  3.792276012518409*^9, 
  3.792276018186392*^9}},ExpressionUUID->"91c1c095-25cf-494a-825f-\
3e7903836dd9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Get", "[", 
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<Poissonpth.wl\>\""}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.79175709813412*^9, 3.791757136502431*^9}, {
  3.791757212448909*^9, 3.7917572187982883`*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"d135e770-720f-46b2-b434-a48582b42c6e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Poisson0", "[", 
    RowBox[{"f1_", ",", "f2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"a", "=", "1"}], "3"], 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"b", "=", "1"}], "3"], 
      RowBox[{
       RowBox[{
        SubscriptBox["\[PartialD]", 
         RowBox[{"p", "[", "a", "]"}]], "f1"}], 
       RowBox[{
        SubscriptBox["\[PartialD]", 
         RowBox[{"\[Theta]", "[", "b", "]"}]], "f2"}], " ", 
       RowBox[{"Poissonp\[Theta]", "[", 
        RowBox[{"[", 
         RowBox[{"a", ",", "b"}], "]"}], "]"}]}]}]}], "-", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"a", "=", "1"}], "3"], 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"b", "=", "1"}], "3"], 
      RowBox[{
       RowBox[{
        SubscriptBox["\[PartialD]", 
         RowBox[{"\[Theta]", "[", "b", "]"}]], "f1"}], 
       RowBox[{
        SubscriptBox["\[PartialD]", 
         RowBox[{"p", "[", "a", "]"}]], "f2"}], " ", 
       RowBox[{"Poissonp\[Theta]", "[", 
        RowBox[{"[", 
         RowBox[{"a", ",", "b"}], "]"}], "]"}]}]}]}], "+", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"a", "=", "1"}], "3"], 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"b", "=", "1"}], "3"], 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"c", "=", "1"}], "3"], 
       RowBox[{
        RowBox[{"(", 
         FractionBox[
          RowBox[{"-", "\[Kappa]"}], 
          SuperscriptBox["aa", "2"]], ")"}], 
        RowBox[{
         RowBox[{"LeviCivitaTensor", "[", "3", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"a", ",", "b", ",", "c"}], "]"}], "]"}], 
        RowBox[{"p", "[", "c", "]"}], 
        RowBox[{
         SubscriptBox["\[PartialD]", 
          RowBox[{"p", "[", "a", "]"}]], "f1"}], 
        RowBox[{
         SubscriptBox["\[PartialD]", 
          RowBox[{"p", "[", "b", "]"}]], "f2"}]}]}]}]}]}]}], ";"}]], "Input",
 CellLabel->"In[17]:=",ExpressionUUID->"b28e3377-71fb-40d4-97c8-2c900869ffeb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pandp", "=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"Poisson0", "[", 
      RowBox[{
       RowBox[{"p", "[", "a", "]"}], ",", 
       RowBox[{"p", "[", "b", "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pand\[Theta]", "=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"Poisson0", "[", 
      RowBox[{
       RowBox[{"p", "[", "a", "]"}], ",", 
       RowBox[{"\[Theta]", "[", "b", "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]andp", "=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"Poisson0", "[", 
      RowBox[{
       RowBox[{"\[Theta]", "[", "a", "]"}], ",", 
       RowBox[{"p", "[", "b", "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7917574115656424`*^9, 3.791757504340703*^9}, {
  3.792100855884651*^9, 3.792100858261065*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"b26decbb-6ac9-4dae-80e9-223abe0c8dac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PTrans", "=", 
   RowBox[{"ArrayFlatten", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pandp", ",", "pand\[Theta]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]andp", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], "}"}]}], 
     "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.791757527940646*^9, 3.7917575785162907`*^9}, {
   3.791757629311387*^9, 3.791757676996945*^9}, {3.791757707107147*^9, 
   3.7917577366736526`*^9}, 3.791757766895146*^9},
 CellLabel->"In[21]:=",ExpressionUUID->"66cfed2b-b7eb-48e5-9607-d2a4d445aa40"],

Cell[BoxData[
 RowBox[{
  RowBox[{"left", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", 
        SuperscriptBox["aa", "2"]}], "\[Kappa]"], "PTrans"}], ")"}], ".", 
    "Trans1new"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7917578060393467`*^9, 3.791757915156872*^9}, {
  3.7917579762548647`*^9, 3.791758021501012*^9}, {3.7917581042400637`*^9, 
  3.7917581074866533`*^9}, {3.791758163192555*^9, 3.7917581636919727`*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"bc601653-9330-4d82-b44a-065e404fa301"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"leftS", "=", 
  RowBox[{"ParallelTable", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"left", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Theta]1", "\[Rule]", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"\[Theta]", "[", "1", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"\[Theta]", "[", "2", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"\[Theta]", "[", "3", "]"}], "2"]}]]}], ",", 
           RowBox[{"p1", "\[Rule]", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"p", "[", "1", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"p", "[", "2", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"p", "[", "3", "]"}], "2"]}]]}]}], "}"}]}], "//", 
        "FunctionExpand"}], "//", "TrigExpand"}], "//", "Expand"}], "//", 
     "FullSimplify"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "6"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "6"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7918465177120743`*^9, 3.791846529172222*^9}, {
  3.7918465728469963`*^9, 3.791846595507131*^9}, {3.791888828196932*^9, 
  3.791888881351901*^9}, {3.792101064838337*^9, 3.792101070622899*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"89c69d3d-a31c-4de1-914e-6c69cc92cc63"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.791847692283906*^9, 3.791937448371221*^9, 
  3.792145784112591*^9, 3.792478638186153*^9},
 CellLabel->"Out[23]=",ExpressionUUID->"92cabb76-6936-497f-8b6b-bc3f69d9593c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"random", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]", "[", "1", "]"}], "\[Rule]", " ", 
      RowBox[{"RandomVariate", "[", 
       RowBox[{"NormalDistribution", "[", "]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"\[Theta]", "[", "2", "]"}], "\[Rule]", " ", 
      RowBox[{"RandomVariate", "[", 
       RowBox[{"NormalDistribution", "[", "]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"\[Theta]", "[", "3", "]"}], "\[Rule]", " ", 
      RowBox[{"RandomVariate", "[", 
       RowBox[{"NormalDistribution", "[", "]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"p", "[", "1", "]"}], "\[Rule]", " ", 
      RowBox[{"RandomVariate", "[", 
       RowBox[{"NormalDistribution", "[", "]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"p", "[", "2", "]"}], "\[Rule]", " ", 
      RowBox[{"RandomVariate", "[", 
       RowBox[{"NormalDistribution", "[", "]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"p", "[", "3", "]"}], "\[Rule]", " ", 
      RowBox[{"RandomVariate", "[", 
       RowBox[{"NormalDistribution", "[", "]"}], "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"left", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Theta]1", "\[Rule]", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"\[Theta]", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"\[Theta]", "[", "2", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"\[Theta]", "[", "3", "]"}], "2"]}]]}], ",", 
        RowBox[{"p1", "\[Rule]", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"p", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"p", "[", "2", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"p", "[", "3", "]"}], "2"]}]]}]}], "}"}]}], ")"}], "/.", 
    "random"}], "//", "Chop"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.791845477569031*^9, 3.7918454870422993`*^9}, {
  3.7918455872797623`*^9, 3.79184567721668*^9}, {3.792100935786949*^9, 
  3.792100936243431*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"cfca480b-2519-4def-9029-0d3f5ed98573"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1.0000000000000016`", "0", "0", "0", "0", "0"},
     {"0", "1.0000000000000022`", "0", "0", "0", "0"},
     {"0", "0", "1.000000000000002`", "0", "0", "0"},
     {"0", "0", "0", "0.9999999999999997`", "0", "0"},
     {"0", "0", "0", "0", "0.9999999999999991`", "0"},
     {"0", "0", "0", "0", "0", "0.9999999999999996`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.79210094100169*^9, 3.792146508838973*^9, 
  3.792478641578773*^9},
 CellLabel->
  "Out[25]//MatrixForm=",ExpressionUUID->"58a054a7-6698-42f0-abbb-\
b9d93fe45730"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{941, 702},
WindowMargins->{{93, Automatic}, {Automatic, 34}},
FrontEndVersion->"12.0 for Linux x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[400, 13, 629, 14, 31, "Input",ExpressionUUID->"fa31f06f-1395-4700-9c98-b09de72c2660"],
Cell[1032, 29, 330, 8, 31, "Input",ExpressionUUID->"a1f611c8-3817-430b-b5b7-b1e751e62667"],
Cell[CellGroupData[{
Cell[1387, 41, 164, 3, 55, "Subsection",ExpressionUUID->"408318d0-bf28-4d20-a7ed-a08506b66a6e"],
Cell[1554, 46, 1841, 44, 101, "Input",ExpressionUUID->"daffbecf-2cb4-4b7c-a07c-28da81d8e96c"],
Cell[3398, 92, 3293, 82, 162, "Input",ExpressionUUID->"b16e6039-2594-43d5-ae51-bbefffc220b1"],
Cell[6694, 176, 3048, 79, 162, "Input",ExpressionUUID->"2e03c341-f0d7-43f2-b75a-7b4918f71a28"],
Cell[9745, 257, 1103, 32, 55, "Input",ExpressionUUID->"d6042bc0-baa2-473d-9ccd-def4697f56d5"],
Cell[CellGroupData[{
Cell[10873, 293, 5112, 138, 642, "Input",ExpressionUUID->"b9ff97bf-be77-4fa2-a543-7fdcf45b2725"],
Cell[15988, 433, 381, 10, 35, "Output",ExpressionUUID->"428e4306-195b-494e-9f9a-1dda096b8901"],
Cell[16372, 445, 381, 10, 35, "Output",ExpressionUUID->"b333bc72-4366-4057-a99b-3b1e3b627a89"]
}, Open  ]],
Cell[16768, 458, 669, 18, 57, "Input",ExpressionUUID->"5711d008-b564-4263-b8ee-fa66d156fe38"],
Cell[CellGroupData[{
Cell[17462, 480, 846, 23, 31, "Input",ExpressionUUID->"aa2291c4-17b6-4159-abf0-fc6029b453c2"],
Cell[18311, 505, 2330, 67, 40, "Output",ExpressionUUID->"55ac17c6-cc4f-4a2e-8d69-02ebe4131ce6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20678, 577, 797, 22, 31, "Input",ExpressionUUID->"687f7d54-08a5-4959-a0c0-81fd2a43efb1"],
Cell[21478, 601, 2304, 67, 40, "Output",ExpressionUUID->"a96f2672-5d7a-420f-ac44-78f104245485"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[23831, 674, 1673, 55, 110, "Subsection",ExpressionUUID->"8e523cf8-be33-462f-9362-5cc03d18a502"],
Cell[25507, 731, 209, 4, 36, "Text",ExpressionUUID->"852bb0fc-dec5-490c-b850-eba0f7b3a3a5"],
Cell[25719, 737, 762, 16, 55, "Input",ExpressionUUID->"f88e32ab-bc65-4ab7-90d1-2a6b60987a33"],
Cell[26484, 755, 2806, 72, 176, "Input",ExpressionUUID->"63bbeef8-5234-4a8d-919e-d6345ca61474"],
Cell[29293, 829, 1599, 42, 142, "Input",ExpressionUUID->"17d12ff0-3b92-4176-9cf4-140e60fcb381"],
Cell[30895, 873, 2634, 70, 176, "Input",ExpressionUUID->"a27e614b-857b-4df1-9d44-1ba347e1f0f0"],
Cell[33532, 945, 1605, 42, 142, "Input",ExpressionUUID->"89a6c905-4a8c-4d56-bd27-652a965a021d"],
Cell[35140, 989, 1637, 44, 122, "Input",ExpressionUUID->"adbfe21b-60ad-4b8a-863d-d573e35eeea9"],
Cell[36780, 1035, 1633, 44, 122, "Input",ExpressionUUID->"00aeaebb-176a-4259-b88c-04c81232f2ff"],
Cell[38416, 1081, 1716, 56, 81, "Text",ExpressionUUID->"df5405de-0929-479f-9fc6-c31e9fe6f54b"],
Cell[40135, 1139, 1806, 36, 78, "Input",ExpressionUUID->"67d1f21e-a708-42cf-b7f6-f9bc700f218e"],
Cell[CellGroupData[{
Cell[41966, 1179, 961, 25, 124, "Input",ExpressionUUID->"b794552f-b7ce-4220-9baf-3d81826b89f2"],
Cell[42930, 1206, 7914, 229, 94, "Output",ExpressionUUID->"3fe2d486-b752-4753-89e2-07f507af6ca3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50881, 1440, 240, 4, 31, "Input",ExpressionUUID->"09a09480-7e62-4040-b5cc-5ce0118c8c15"],
Cell[51124, 1446, 381, 14, 221, "Output",ExpressionUUID->"550fe9dd-c2b0-4fb7-9799-c8ecd4e64765"]
}, Open  ]],
Cell[51520, 1463, 324, 7, 31, "Input",ExpressionUUID->"61b38d8f-6c4b-440f-8adc-c4b1d9d3de03"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51881, 1475, 223, 4, 68, "Section",ExpressionUUID->"91c1c095-25cf-494a-825f-3e7903836dd9"],
Cell[52107, 1481, 359, 8, 31, "Input",ExpressionUUID->"d135e770-720f-46b2-b434-a48582b42c6e"],
Cell[52469, 1491, 2107, 63, 121, "Input",ExpressionUUID->"b28e3377-71fb-40d4-97c8-2c900869ffeb"],
Cell[54579, 1556, 1446, 41, 78, "Input",ExpressionUUID->"b26decbb-6ac9-4dae-80e9-223abe0c8dac"],
Cell[56028, 1599, 800, 20, 31, "Input",ExpressionUUID->"66cfed2b-b7eb-48e5-9607-d2a4d445aa40"],
Cell[56831, 1621, 584, 14, 57, "Input",ExpressionUUID->"bc601653-9330-4d82-b44a-065e404fa301"],
Cell[CellGroupData[{
Cell[57440, 1639, 1597, 41, 132, "Input",ExpressionUUID->"89c69d3d-a31c-4de1-914e-6c69cc92cc63"],
Cell[59040, 1682, 860, 23, 59, "Output",ExpressionUUID->"92cabb76-6936-497f-8b6b-bc3f69d9593c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59937, 1710, 2259, 59, 151, "Input",ExpressionUUID->"cfca480b-2519-4def-9029-0d3f5ed98573"],
Cell[62199, 1771, 961, 24, 137, "Output",ExpressionUUID->"58a054a7-6698-42f0-abbb-b9d93fe45730"]
}, Open  ]]
}, Open  ]]
}
]
*)

